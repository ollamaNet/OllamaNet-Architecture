@startuml Container Diagram

package "ConversationService" {
  [ChatController] as CC
  [ConversationController] as ConvC
  [IChatService] as ICS
  [IConversationService] as IConvS
  [ChatHistoryManager] as HM
  [CacheManager] as Cache
  [UnitOfWork] as UOW
}

package "External Services" {
  [API Gateway] as Gateway
  [Ollama Service] as Ollama
  [Database] as DB
  [Redis Cache] as Redis
}

' Internal Communication
CC --> ICS : Process Messages
ConvC --> IConvS : Manage Conversations
ICS --> HM : Manage History
HM --> Cache : Cache Operations
Cache --> Redis : Distributed Cache
HM --> UOW : Data Access
UOW --> DB : Persistence

' External Communication
Gateway --> CC : HTTP Requests
Gateway --> ConvC : HTTP Requests
ICS --> Ollama : Model Inference

note right of ICS
  Core Business Logic:
  - Message Processing
  - Conversation Management
  - History Tracking
end note

note right of HM
  History Management:
  - Chat History
  - Caching Strategy
  - Data Persistence
end note

@enduml 